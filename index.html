<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>JARVIS AI Voice Assistant</title>
  <style>
    body {
      background: radial-gradient(#0f0f0f, #000000);
      color: #00ffe1;
      font-family: 'Segoe UI', sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      overflow: hidden;
      margin: 0;
    }
    .jarvis-container {
      text-align: center;
      max-width: 600px;
    }
    h1 {
      font-size: 3em;
      color: #00ffe1;
      text-shadow: 0 0 10px #00ffe1;
      margin-bottom: 10px;
    }
    .status {
      color: #bbb;
      font-size: 1.1em;
      margin-top: 10px;
    }
    .log {
      margin-top: 30px;
      font-size: 0.95em;
      max-height: 300px;
      overflow-y: auto;
      background: rgba(255, 255, 255, 0.05);
      padding: 10px;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <div class="jarvis-container">
    <h1>ðŸ§  J.A.R.V.I.S</h1>
    <div class="status" id="status">Initializing...</div>
    <div class="log" id="log"></div>
  </div>

  <script>
    const statusEl = document.getElementById('status');
    const logEl = document.getElementById('log');

    const synth = window.speechSynthesis;
    const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
    recognition.continuous = true;
    recognition.lang = 'en-US';

    function log(text) {
      const entry = document.createElement('div');
      entry.textContent = text;
      logEl.appendChild(entry);
      logEl.scrollTop = logEl.scrollHeight;
    }

    function speak(text) {
      if (synth.speaking) synth.cancel();
      const utter = new SpeechSynthesisUtterance(text);
      utter.lang = "en-US";
      utter.rate = 1.05;
      utter.pitch = 1.2;
      synth.speak(utter);
      log("JARVIS: " + text);
    }

    function respond(command) {
      const lower = command.toLowerCase();

      if (lower.includes("hello") || lower.includes("hi")) {
        speak("Hello, how can I assist you today?");
      } else if (lower.includes("weather")) {
        fetch("https://ipapi.co/json")
          .then(res => res.json())
          .then(loc => {
            fetch(`https://wttr.in/${loc.city}?format=3`)
              .then(r => r.text())
              .then(weather => speak("Current weather: " + weather))
              .catch(() => speak("Sorry, I couldn't fetch weather info."));
          });
      } else if (lower.includes("play music")) {
        speak("Playing music from your browser.");
        const audio = new Audio("https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3");
        audio.play();
      } else if (lower.includes("time")) {
        const now = new Date();
        speak(`It is currently ${now.toLocaleTimeString()}`);
      } else if (lower.includes("date")) {
        const now = new Date();
        speak(`Today is ${now.toDateString()}`);
      } else if (lower.includes("remind me")) {
        const task = lower.replace("remind me", "").trim();
        const date = new Date();
        const reminder = {
          task,
          time: new Date(date.getTime() + 24 * 60 * 60 * 1000).toDateString() // remind tomorrow
        };
        const reminders = JSON.parse(localStorage.getItem("reminders") || "[]");
        reminders.push(reminder);
        localStorage.setItem("reminders", JSON.stringify(reminders));
        speak(`Okay, I will remind you to ${task} tomorrow.`);
      } else if (lower.includes("who are you") || lower.includes("your name")) {
        speak("I am JARVIS, your AI assistant.");
      } else {
        speak("Let me search that...");
        fetch(`https://api.duckduckgo.com/?q=${encodeURIComponent(command)}&format=json`)
          .then(res => res.json())
          .then(data => {
            if (data.AbstractText) speak(data.AbstractText);
            else speak("Sorry, I have no information on that.");
          })
          .catch(() => speak("An error occurred while fetching the answer."));
      }
    }

    function checkReminders() {
      const today = new Date().toDateString();
      const reminders = JSON.parse(localStorage.getItem("reminders") || "[]");
      const todays = reminders.filter(r => r.time === today);
      todays.forEach(r => speak(`Reminder: ${r.task}`));
      localStorage.setItem("reminders", JSON.stringify(reminders.filter(r => r.time !== today)));
    }

    recognition.onstart = () => {
      statusEl.textContent = "Listening...";
    };

    recognition.onresult = (event) => {
      const transcript = event.results[event.results.length - 1][0].transcript.trim();
      log("You: " + transcript);
      respond(transcript);
    };

    recognition.onerror = (e) => {
      statusEl.textContent = "Error occurred: " + e.error;
      recognition.stop();
      setTimeout(() => recognition.start(), 2000);
    };

    recognition.onend = () => {
      recognition.start();
    };

    window.onload = () => {
      document.body.addEventListener("click", () => {
        const dummy = new SpeechSynthesisUtterance("");
        synth.speak(dummy);
      }, { once: true });

      checkReminders();
      recognition.start();
      speak("System online. Awaiting your command.");
    };
  </script>
</body>
</html>
